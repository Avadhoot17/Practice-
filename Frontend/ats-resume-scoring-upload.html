<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ATS Resume Scoring</title>

<style>
* {
  box-sizing: border-box;
  font-family: system-ui, -apple-system, sans-serif;
}

body {
  margin: 0;
  min-height: 100vh;
  background: linear-gradient(135deg, #0f172a, #020617);
  color: #e5e7eb;
  display: flex;
  justify-content: center;
  align-items: center;
}

.app {
  width: 560px;
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(18px);
  border-radius: 22px;
  padding: 24px;
  box-shadow: 0 30px 60px rgba(0,0,0,0.6);
}

h1 {
  text-align: center;
  font-size: 22px;
  margin-bottom: 14px;
}

input[type="file"] {
  width: 100%;
  margin-bottom: 12px;
  padding: 10px;
  background: rgba(255,255,255,0.1);
  border-radius: 12px;
  border: none;
  color: white;
}

textarea {
  width: 100%;
  height: 160px;
  padding: 14px;
  border-radius: 14px;
  border: none;
  outline: none;
  resize: none;
  font-size: 14px;
}

button {
  width: 100%;
  margin-top: 14px;
  padding: 14px;
  border-radius: 14px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  background: linear-gradient(135deg, #38bdf8, #6366f1);
  color: #020617;
}

.score-box {
  margin-top: 18px;
  padding: 16px;
  border-radius: 16px;
  background: rgba(255,255,255,0.08);
  display: none;
}

.score {
  font-size: 32px;
  font-weight: 700;
  text-align: center;
}

.feedback {
  margin-top: 12px;
  font-size: 14px;
}

ul {
  margin-top: 8px;
  padding-left: 18px;
}
</style>
</head>

<body>

<div class="app">
  <h1>ATS Resume Scoring</h1>

  <input type="file" id="fileInput" accept=".pdf,.txt" />

  <textarea id="resumeText" placeholder="Or paste resume text here..."></textarea>

  <button onclick="analyze()">Analyze Resume</button>

  <div class="score-box" id="result">
    <div class="score" id="score"></div>
    <div class="feedback" id="feedback"></div>
  </div>
</div>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

<script>
const fileInput = document.getElementById("fileInput");
const resumeTextArea = document.getElementById("resumeText");

fileInput.addEventListener("change", async () => {
  const file = fileInput.files[0];
  if (!file) return;

  if (file.type === "text/plain") {
    const text = await file.text();
    resumeTextArea.value = text;
  } 
  else if (file.type === "application/pdf") {
    const reader = new FileReader();
    reader.onload = async function () {
      const typedarray = new Uint8Array(this.result);
      const pdf = await pdfjsLib.getDocument(typedarray).promise;
      let text = "";

      for (let i = 1; i <= pdf.numPages; i++) {
        const page = await pdf.getPage(i);
        const content = await page.getTextContent();
        content.items.forEach(item => {
          text += item.str + " ";
        });
      }

      resumeTextArea.value = text;
    };
    reader.readAsArrayBuffer(file);
  }
});

function analyze() {
  const text = resumeTextArea.value.toLowerCase().trim();
  if (!text) return;

  let score = 0;
  let feedback = [];

  // Skills (40)
  const skills = [
    "html","css","javascript","react","java","python","sql",
    "mysql","node","api","rest","git","problem solving"
  ];

  const skillCount = skills.filter(s => text.includes(s)).length;
  score += Math.min(skillCount * 3, 40);

  feedback.push(
    skillCount >= 6
      ? "Strong technical skills detected"
      : "Add more job-relevant technical skills"
  );

  // Experience (25)
  if (text.includes("experience") || text.includes("intern")) {
    score += 15;
    if (/\d+\+?\s*(year|years|month|months)/.test(text)) {
      score += 10;
      feedback.push("Experience duration mentioned");
    } else {
      feedback.push("Mention experience duration");
    }
  } else {
    feedback.push("Experience section missing");
  }

  // Education (15)
  if (/(bca|btech|mca|msc|degree|university)/.test(text)) {
    score += 15;
    feedback.push("Education section found");
  } else {
    feedback.push("Add education details");
  }

  // Projects (10)
  if (text.includes("project")) {
    score += 10;
    feedback.push("Projects included");
  } else {
    feedback.push("Projects missing");
  }

  // Length (10)
  score += text.length > 800 ? 10 : 5;

  score = Math.min(score, 100);

  document.getElementById("score").textContent = score + " / 100";
  document.getElementById("feedback").innerHTML =
    "<strong>ATS Feedback</strong><ul>" +
    feedback.map(f => `<li>${f}</li>`).join("") +
    "</ul>";

  document.getElementById("result").style.display = "block";
}
</script>

</body>
</html>
