<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal Code Editor Pro</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Consolas,monospace}

body{
  min-height:100vh;
  background:#0f172a;
  color:#e2e8f0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}

.app{
  width:100%;
  max-width:1200px;
  height:92vh;
  background:#020617;
  border-radius:16px;
  display:grid;
  grid-template-rows:52px 1fr 170px;
  overflow:hidden;
  box-shadow:0 25px 60px rgba(0,0,0,.45);
}

.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 14px;
  border-bottom:1px solid #1e293b;
  background:#020617;
}

.title{font-size:14px;color:#38bdf8}

.controls{display:flex;gap:6px;align-items:center}

select,button{
  background:#020617;
  color:#e2e8f0;
  border:1px solid #334155;
  padding:6px 10px;
  border-radius:8px;
  font-size:12px;
}

button{
  background:#38bdf8;
  color:#020617;
  border:none;
  cursor:pointer;
  transition:.2s;
}
button:hover{transform:translateY(-1px)}

.editor{
  display:grid;
  grid-template-columns:60px 1fr;
}

.lines{
  padding:10px 6px;
  text-align:right;
  color:#64748b;
  font-size:12px;
  border-right:1px solid #1e293b;
}

textarea{
  width:100%;
  height:100%;
  background:#020617;
  color:#e2e8f0;
  border:none;
  outline:none;
  padding:10px;
  font-size:13px;
  line-height:1.5;
  resize:none;
}

.console{
  background:#000;
  border-top:1px solid #1e293b;
  padding:10px;
  font-size:12px;
  color:#22c55e;
  overflow:auto;
}
</style>
</head>

<body>

<div class="app">

<div class="topbar">
  <div class="title">Universal Playground Editor Pro</div>

  <div class="controls">
    <select id="language">
      <option value="javascript">JavaScript</option>
      <option value="python">Python</option>
      <option value="java">Java</option>
      <option value="c">C</option>
      <option value="cpp">C++</option>
    </select>

    <button onclick="runCode()">Run</button>
    <button onclick="clearCode()">Clear</button>
    <button onclick="downloadCode()">Download</button>
  </div>
</div>

<div class="editor">
  <div class="lines" id="lines"></div>
  <textarea id="code" spellcheck="false">console.log("Hello World");</textarea>
</div>

<div class="console" id="console">Output will appear here...</div>

</div>

<script>
const codeArea=document.getElementById('code');
const lines=document.getElementById('lines');
const consoleBox=document.getElementById('console');
const langSelect=document.getElementById('language');

function updateLines(){
  const count=codeArea.value.split('\n').length;
  lines.innerHTML=Array.from({length:count},(_,i)=>i+1).join('<br>');
}

codeArea.addEventListener('input',updateLines);
updateLines();

async function runCode(){
  const code=codeArea.value;
  const lang=langSelect.value;

  try{
    if(lang==='javascript'){
      // Support import by running inside dynamic module
      const blob=new Blob([code],{type:'text/javascript'});
      const url=URL.createObjectURL(blob);

      consoleBox.textContent='Running JavaScript module...';

      const module=await import(url);

      if(module?.default!==undefined)
        consoleBox.textContent=String(module.default);
      else
        consoleBox.textContent='JavaScript executed successfully.';
    }

    else if(lang==='python'){
      consoleBox.textContent='Python needs backend or Pyodide. (Simulation mode)';
    }

    else if(lang==='java'){
      const match=code.match(/System\.out\.println\((.*?)\)/g);
      if(!match){consoleBox.textContent='Java executed. (println simulation only)';return;}
      consoleBox.textContent=match.map(l=>l.match(/\((.*?)\)/)[1].replaceAll('"','')).join('\n');
    }

    else if(lang==='c'||lang==='cpp'){
      consoleBox.textContent='C/C++ require real compiler backend. (Simulation)';
    }
  }
  catch(err){
    consoleBox.textContent='Error: '+err.message;
  }
}

function clearCode(){
  codeArea.value='';
  consoleBox.textContent='Cleared.';
  updateLines();
}

function downloadCode(){
  const ext={javascript:'js',python:'py',java:'java',c:'c',cpp:'cpp'}[langSelect.value];
  const blob=new Blob([codeArea.value],{type:'text/plain'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='code.'+ext;
  a.click();
}
</script>

</body>
</html>
